"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([["62742"],{64332:function(e,s,n){n.r(s),n.d(s,{default:()=>p,frontMatter:()=>o,metadata:()=>t,assets:()=>c,toc:()=>l,contentTitle:()=>a});var t=JSON.parse('{"id":"Documentation/PlatformAPIs/SRSE/SRRisk","title":"SR Risk database","description":"Overview","source":"@site/docs/Documentation/PlatformAPIs/SRSE/6.SRRisk.md","sourceDirName":"Documentation/PlatformAPIs/SRSE","slug":"/Documentation/PlatformAPIs/SRSE/SRRisk","permalink":"/docs/next/Documentation/PlatformAPIs/SRSE/SRRisk","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"title":"SR Risk database","sidebar_position":6},"sidebar":"documentationSidebar","previous":{"title":"SR Auction database","permalink":"/docs/next/Documentation/PlatformAPIs/SRSE/SRAuction"},"next":{"title":"SR Control database","permalink":"/docs/next/Documentation/PlatformAPIs/SRSE/SRControl"}}'),r=n("52676"),i=n("91503");let o={title:"SR Risk database",sidebar_position:6},a=void 0,c={},l=[{value:"Overview",id:"overview",level:2},{value:"SR Risk Tables",id:"sr-risk-tables",level:2},{value:"Query Examples",id:"query-examples",level:2},{value:"Start-of-Day and Position Records",id:"start-of-day-and-position-records",level:3},{value:"Symbol-Level Summary and Risk Cube Detail",id:"symbol-level-summary-and-risk-cube-detail",level:3}];function d(e){let s={code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:"Prior day SpiderRock Connect archived positions and marks"}),"\n",(0,r.jsx)(s.li,{children:"Start-of-period clearing firm positions and marks"}),"\n",(0,r.jsx)(s.li,{children:"SpiderRock Connect executions and inbound away drops"}),"\n",(0,r.jsx)(s.li,{children:"Live position greeks and slide risk across entire portfolio"}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"sr-risk-tables",children:"SR Risk Tables"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"SR Risk Tables",src:n(67933).Z+"",width:"261",height:"449"})}),"\n",(0,r.jsx)(s.h2,{id:"query-examples",children:"Query Examples"}),"\n",(0,r.jsx)(s.h3,{id:"start-of-day-and-position-records",children:"Start-of-Day and Position Records"}),"\n",(0,r.jsx)(s.p,{children:"SpiderRock can receive Start-of-Day (SOD) records from either a clearing source or directly from individual firms. These records are loaded into the SOD Clearing Record V5 table. Once they are in the SpiderRock system, the SOD records populate the Position Record tables.\nEach Position Record table contains both SOD data and any intra-day trades that have occurred. Clients can view this table as the base record of their risk exposure within the SpiderRock system.\nThere is a base risk record for each asset type\u2014options, stocks, and futures. Each base record rolls up into two types of summary records:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Risk Cube Detail:"})," provides risk data used in the Risk Manager"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.strong,{children:"Symbol Risk Summary:"})," provides symbol-level risk data displayed in the Symbol Viewer, Risk Viewer, and the Hedge Tool\nBelow are example queries that can be used to access each of these record types."]}),"\n"]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Sample Query 1: Inserting a SOD record"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:"DESCRIBE srrisk.msgsodclearingrecordv5;\nINSERT INTO srrisk.msgsodclearingrecordv5 (accnt,clientfirm,seckey_at,seckey_ts,seckey_tk,seckey_yr,seckey_mn,seckey_dy,seckey_xx,seckey_cp,sectype,tradedate,clrposition,clrmark,TIMESTAMP)\nVALUES ('T.ACCNT','SRCORE','EQT','NMS','AAPL',2025,10,17,225,'Call','Option','2025-09-12', 123, 12.50, NOW());   \nSELECT * FROM srrisk.msgsodclearingrecordv5\nWHERE accnt = 'T.ACCNT';\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Sample Query 2: The base risk records. To see the current position, a user must add the start of day position to the bot minus the sold."})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Option:"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:"SELECT okey_tk,okey_yr,okey_mn,okey_dy,okey_xx,okey_cp,optopnpos AS startofdaypostions,cnbot AS contractsbot,cnsld AS contractssold,optopnpos+cnbot-cnsld AS currentposition,a.*\nFROM srrisk.msgoptionpositionrecordv5 a\nWHERE accnt = 'T.ACCNT' AND tradedate = CURRENT_DATE;\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Option Position Record",src:n(22296).Z+"",width:"624",height:"64"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Stock:"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:"SELECT ticker_tk,stkopnpos AS startofdaypositon,shbot AS sharesbot, shsld AS sharessold,stkopnpos+shbot-shsld AS currentposition,a.*\nFROM srrisk.msgstockpositionrecordV5 a\nWHERE accnt = 'T.ACCNT' AND tradedate = CURRENT_DATE;\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Stock Position Record",src:n(53184).Z+"",width:"624",height:"120"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Future:"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:"SELECT fkey_tk,fkey_yr,fkey_mn,fkey_dy,futopnpos AS startofdayposition,cnbot AS contractsbot,cnsld AS contractssold,futopnpos+cnbot-cnsld AS currentposition,a.*\nFROM srrisk.msgfuturepositionrecordv5 a\nWHERE accnt = 'T.ACCNT' AND tradedate = CURRENT_DATE;\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Future Position Record",src:n(74010).Z+"",width:"624",height:"37"})}),"\n",(0,r.jsx)(s.h3,{id:"symbol-level-summary-and-risk-cube-detail",children:"Symbol-Level Summary and Risk Cube Detail"}),"\n",(0,r.jsx)(s.p,{children:"These positions roll up into two summary views. The first is the SymbolRiskSummary table, which provides a symbol-level summary of risk data. All the information displayed in the Symbol Summary in the Symbol Viewer, Risk Viewer, and Hedge Tool is available in this table."}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Sample Query 3: Check the SymbolRiskSummary table"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:"SELECT Ticker_tk,delta,ddelta,gamma,theta,a.*\nFROM srrisk.msgsymbolrisksummaryv5 a\nWHERE accnt = 'T.ACCNT' AND tradedate = CURRENT_DATE;\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Symbol Risk Summary",src:n(67803).Z+"",width:"624",height:"168"})}),"\n",(0,r.jsx)(s.p,{children:"The next roll-up view is the RiskCubeDetail table, which combines position data across all asset classes. This view contains the same information displayed in the Risk Manager and allows users to aggregate symbol or account risk."}),"\n",(0,r.jsx)(s.p,{children:"Like the Position Records, users must combine the Start-of-Day (SOD) records with the bought and sold quantities to determine the current position. Because this table evaluates all securities simultaneously, the primary keys used for identification are the SecKeys."}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Sample Query 4: Check the RiskCubeDetail table"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:"SELECT seckey_tk,seckey_yr,seckey_mn,seckey_dy,seckey_xx,seckey_cp,sectype,shopnpos+shbot-shsld AS currentsharespos,fcopnpos+fcbot-fcsld AS currentfutpos,cnopnpos+cnbot-cnsld AS currentoptpos,a.*\nFROM srrisk.msgriskcubedetailv5 a\nWHERE accnt = 'T.ACCNT' AND tradedate = CURRENT_DATE;\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Risk Cube Detail",src:n(69706).Z+"",width:"624",height:"206"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Sample Query 5: Pull position PnL from the Risk cube detail record"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:"SELECT seckey_tk,seckey_yr,seckey_mn,seckey_dy,seckey_xx,seckey_cp,sectype,shopnpos+shbot-shsld AS currentsharespos,fcopnpos+fcbot-fcsld AS currentfutpos,cnopnpos+cnbot-cnsld AS currentoptpos,opnpnlvolmark AS VolPnl,opnpnlde AS PnlDelta,opnpnlga AS PnlGamma,\nopnpnlTh AS PnlTheta,opnpnlve AS PnlVega,opnpnlvo AS PnlVolga,opnpnlva AS PnlVanna,opnpnlRate AS PnlRate,opnpnlsdiv AS PnlSdiv, opnpnlDdiv AS PnlDividend,opnpnlErr AS PnlError\nFROM srrisk.msgriskcubedetailv5 a\nWHERE accnt = 'T.ACCNT' AND seckey_tk = 'AAPL' AND tradedate = CURRENT_DATE;\n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Position PnL",src:n(549).Z+"",width:"1765",height:"74"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Sample Query 6: Check for current risk status of an account"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-sql",children:"SELECT * FROM srrisk.msgaccountriskrecordv5 WHERE accnt='T.ACCNT'; \n"})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.img,{alt:"Account Risk Record",src:n(23714).Z+"",width:"1277",height:"127"})})]})}function p(e={}){let{wrapper:s}={...(0,i.a)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},23714:function(e,s,n){n.d(s,{Z:function(){return t}});let t=n.p+"assets/images/accountriskrecord-e15d7d1e4013d5d7155ec5ca96a07e1c.png"},67933:function(e,s,n){n.d(s,{Z:function(){return t}});let t=n.p+"assets/images/databasetables-8dd5762201097d979c46e7ad523a10d1.png"},74010:function(e,s,n){n.d(s,{Z:function(){return t}});let t=n.p+"assets/images/futurepositionrecord-d4f4e1ac0f831ef79abe134750377f1d.png"},22296:function(e,s,n){n.d(s,{Z:function(){return t}});let t=n.p+"assets/images/optionpositionrecord-8a20e51d0768c70f86d0c54062091b2a.png"},549:function(e,s,n){n.d(s,{Z:function(){return t}});let t=n.p+"assets/images/positionPnLriskcubedetail-7fd5faef031b9717ab083b91553d6544.png"},69706:function(e,s,n){n.d(s,{Z:function(){return t}});let t=n.p+"assets/images/riskcubedetail-bdb0be291a9a6e0738ae809b26deccd3.png"},53184:function(e,s,n){n.d(s,{Z:function(){return t}});let t=n.p+"assets/images/stockpositionrecord-8270d4fd7fe2374383a7941e15ff8c2e.png"},67803:function(e,s,n){n.d(s,{Z:function(){return t}});let t=n.p+"assets/images/symbolrisksummary-2943c3fd03a31545bf90967afe7dffe9.png"},91503:function(e,s,n){n.d(s,{Z:function(){return a},a:function(){return o}});var t=n(75271);let r={},i=t.createContext(r);function o(e){let s=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(i.Provider,{value:s},e.children)}}}]);