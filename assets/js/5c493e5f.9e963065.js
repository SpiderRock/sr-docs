"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([["80912"],{218832(e,s,n){n.r(s),n.d(s,{metadata:()=>t,default:()=>m,frontMatter:()=>a,contentTitle:()=>c,toc:()=>d,assets:()=>l});var t=JSON.parse('{"id":"Documentation/PlatformAPIs/SRSE/SRRisk","title":"SR Risk","description":"Overview","source":"@site/docs/Documentation/PlatformAPIs/SRSE/6.SRRisk.md","sourceDirName":"Documentation/PlatformAPIs/SRSE","slug":"/Documentation/PlatformAPIs/SRSE/SRRisk","permalink":"/docs/next/Documentation/PlatformAPIs/SRSE/SRRisk","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"title":"SR Risk","sidebar_position":6},"sidebar":"documentationSidebar","previous":{"title":"SR Auction","permalink":"/docs/next/Documentation/PlatformAPIs/SRSE/SRAuction"},"next":{"title":"SR Control","permalink":"/docs/next/Documentation/PlatformAPIs/SRSE/SRControl"}}'),o=n(886070),r=n(848193),i=n(607591);let a={title:"SR Risk",sidebar_position:6},c,l={},d=[{value:"Overview",id:"overview",level:2},{value:"SR Risk Tables",id:"sr-risk-tables",level:2},{value:"Query Examples",id:"query-examples",level:2},{value:"Start-of-Day and Position Records",id:"start-of-day-and-position-records",level:3},{value:"Symbol-Level Summary and Risk Cube Detail",id:"symbol-level-summary-and-risk-cube-detail",level:3}];function p(e){let s={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.h2,{id:"overview",children:"Overview"}),"\n",(0,o.jsx)(s.p,{children:"The SR Risk database provides comprehensive risk management data, including position records, marks, and portfolio analytics. Key features include:"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:"Prior day SpiderRock Connect archived positions and marks"}),"\n",(0,o.jsx)(s.li,{children:"Start-of-period clearing firm positions and marks"}),"\n",(0,o.jsx)(s.li,{children:"SpiderRock Connect executions and inbound away drops"}),"\n",(0,o.jsx)(s.li,{children:"Live position Greeks and slide risk across entire portfolio"}),"\n"]}),"\n",(0,o.jsx)(s.h2,{id:"sr-risk-tables",children:"SR Risk Tables"}),"\n",(0,o.jsx)(s.p,{children:"The following image shows the available tables in SR Risk:"}),"\n",(0,o.jsx)(i.B,{src:"/images/PlatformAPIs/SRSE/SRRisk/databasetables.png",alt:"SR Risk Tables"}),"\n",(0,o.jsx)(s.h2,{id:"query-examples",children:"Query Examples"}),"\n",(0,o.jsx)(s.h3,{id:"start-of-day-and-position-records",children:"Start-of-Day and Position Records"}),"\n",(0,o.jsx)(s.p,{children:"SpiderRock can receive Start-of-Day (SOD) records from either a clearing source or directly from individual firms. These records are loaded into the SOD Clearing Record V5 table. Once in the SpiderRock system, the SOD records populate the Position Record tables."}),"\n",(0,o.jsx)(s.p,{children:"Each Position Record table contains both SOD data and any intra-day trades that have occurred. Clients can view this table as the base record of their risk exposure within the SpiderRock system. There is a base risk record for each asset type\u2014options, stocks, and futures. Each base record rolls up into two types of summary records:"}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Risk Cube Detail:"})," Provides risk data used in the Risk Manager"]}),"\n",(0,o.jsxs)(s.li,{children:[(0,o.jsx)(s.strong,{children:"Symbol Risk Summary:"})," Provides symbol-level risk data displayed in the Symbol Viewer, Risk Viewer, and the Hedge Tool"]}),"\n"]}),"\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Sample Query 1:"})," Insert a SOD record:"]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-sql",children:"DESCRIBE srrisk.msgsodclearingrecordv5;\n\nINSERT INTO srrisk.msgsodclearingrecordv5 \n  (accnt, clientfirm, seckey_at, seckey_ts, seckey_tk, seckey_yr, seckey_mn, seckey_dy, \n   seckey_xx, seckey_cp, sectype, tradedate, clrposition, clrmark, TIMESTAMP)\nVALUES \n  ('T.ACCNT', 'SRCORE', 'EQT', 'NMS', 'AAPL', 2025, 10, 17, 225, 'Call', 'Option', \n   '2025-09-12', 123, 12.50, NOW());\n\nSELECT * FROM srrisk.msgsodclearingrecordv5 WHERE accnt = 'T.ACCNT';\n"})}),"\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Sample Query 2:"})," Retrieve base risk records. To see the current position, add the start-of-day position to the bought quantity minus the sold quantity."]}),"\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.strong,{children:"Option Position Record:"})}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-sql",children:"SELECT okey_tk, okey_yr, okey_mn, okey_dy, okey_xx, okey_cp, \n       optopnpos AS startofdaypositions, cnbot AS contractsbot, cnsld AS contractssold, \n       optopnpos+cnbot-cnsld AS currentposition, a.*\nFROM srrisk.msgoptionpositionrecordv5 a\nWHERE accnt = 'T.ACCNT' AND tradedate = CURRENT_DATE;\n"})}),"\n",(0,o.jsx)(i.B,{src:"/images/PlatformAPIs/SRSE/SRRisk/optionpositionrecord.png",alt:"Option Position Record"}),"\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.strong,{children:"Stock Position Record:"})}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-sql",children:"SELECT ticker_tk, stkopnpos AS startofdayposition, shbot AS sharesbot, shsld AS sharessold, \n       stkopnpos+shbot-shsld AS currentposition, a.*\nFROM srrisk.msgstockpositionrecordV5 a\nWHERE accnt = 'T.ACCNT' AND tradedate = CURRENT_DATE;\n"})}),"\n",(0,o.jsx)(i.B,{src:"/images/PlatformAPIs/SRSE/SRRisk/stockpositionrecord.png",alt:"Stock Position Record"}),"\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.strong,{children:"Future Position Record:"})}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-sql",children:"SELECT fkey_tk, fkey_yr, fkey_mn, fkey_dy, futopnpos AS startofdayposition, \n       cnbot AS contractsbot, cnsld AS contractssold, futopnpos+cnbot-cnsld AS currentposition, a.*\nFROM srrisk.msgfuturepositionrecordv5 a\nWHERE accnt = 'T.ACCNT' AND tradedate = CURRENT_DATE;\n"})}),"\n",(0,o.jsx)(i.B,{src:"/images/PlatformAPIs/SRSE/SRRisk/futurepositionrecord.png",alt:"Future Position Record"}),"\n",(0,o.jsx)(s.h3,{id:"symbol-level-summary-and-risk-cube-detail",children:"Symbol-Level Summary and Risk Cube Detail"}),"\n",(0,o.jsx)(s.p,{children:"These positions roll up into two summary views."}),"\n",(0,o.jsxs)(s.p,{children:["The ",(0,o.jsx)(s.a,{href:"https://docs.spiderrockconnect.com/docs/next/MessageSchemas/Schema/Topics/risk-v5/SymbolRiskSummaryV5/",children:"SymbolRiskSummaryV5"})," table provides a symbol-level summary of risk data. All the information displayed in the Symbol Summary in the Symbol Viewer, Risk Viewer, and Hedge Tool is available in this table."]}),"\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Sample Query 3:"})," Retrieve symbol risk summary:"]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-sql",children:"SELECT Ticker_tk, delta, ddelta, gamma, theta, a.*\nFROM srrisk.msgsymbolrisksummaryv5 a\nWHERE accnt = 'T.ACCNT' AND tradedate = CURRENT_DATE;\n"})}),"\n",(0,o.jsx)(i.B,{src:"/images/PlatformAPIs/SRSE/SRRisk/symbolrisksummary.png",alt:"Symbol Risk Summary"}),"\n",(0,o.jsxs)(s.p,{children:["The ",(0,o.jsx)(s.a,{href:"https://docs.spiderrockconnect.com/docs/next/MessageSchemas/Schema/Topics/risk-v5/RiskCubeDetailV5/",children:"RiskCubeDetailV5"})," table combines position data across all asset classes. This view contains the same information displayed in the Risk Manager and allows users to aggregate symbol or account risk. Like the Position Records, users must combine the Start-of-Day (SOD) records with the bought and sold quantities to determine the current position. Because this table evaluates all securities simultaneously, the primary keys used for identification are the SecKeys."]}),"\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Sample Query 4:"})," Retrieve risk cube detail:"]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-sql",children:"SELECT seckey_tk, seckey_yr, seckey_mn, seckey_dy, seckey_xx, seckey_cp, sectype, \n       shopnpos+shbot-shsld AS currentsharespos, fcopnpos+fcbot-fcsld AS currentfutpos, \n       cnopnpos+cnbot-cnsld AS currentoptpos, a.*\nFROM srrisk.msgriskcubedetailv5 a\nWHERE accnt = 'T.ACCNT' AND tradedate = CURRENT_DATE;\n"})}),"\n",(0,o.jsx)(i.B,{src:"/images/PlatformAPIs/SRSE/SRRisk/riskcubedetail.png",alt:"Risk Cube Detail"}),"\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Sample Query 5:"})," Retrieve position PnL from the ",(0,o.jsx)(s.a,{href:"https://docs.spiderrockconnect.com/docs/next/MessageSchemas/Schema/Topics/risk-v5/RiskCubeDetailV5/",children:"RiskCubeDetailV5"})," record:"]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-sql",children:"SELECT seckey_tk, seckey_yr, seckey_mn, seckey_dy, seckey_xx, seckey_cp, sectype, \n       shopnpos+shbot-shsld AS currentsharespos, fcopnpos+fcbot-fcsld AS currentfutpos, \n       cnopnpos+cnbot-cnsld AS currentoptpos, opnpnlvolmark AS VolPnl, opnpnlde AS PnlDelta, \n       opnpnlga AS PnlGamma, opnpnlTh AS PnlTheta, opnpnlve AS PnlVega, opnpnlvo AS PnlVolga, \n       opnpnlva AS PnlVanna, opnpnlRate AS PnlRate, opnpnlsdiv AS PnlSdiv, \n       opnpnlDdiv AS PnlDividend, opnpnlErr AS PnlError\nFROM srrisk.msgriskcubedetailv5 a\nWHERE accnt = 'T.ACCNT' AND seckey_tk = 'AAPL' AND tradedate = CURRENT_DATE;\n"})}),"\n",(0,o.jsx)(i.B,{src:"/images/PlatformAPIs/SRSE/SRRisk/positionPnLriskcubedetail.png",alt:"Position PnL"}),"\n",(0,o.jsxs)(s.p,{children:[(0,o.jsx)(s.strong,{children:"Sample Query 6:"})," Retrieve the current risk status of an account from the ",(0,o.jsx)(s.a,{href:"https://docs.spiderrockconnect.com/docs/next/MessageSchemas/Schema/Topics/risk-v5/AccountRiskRecordV5/",children:"AccountRiskRecordV5"})," table:"]}),"\n",(0,o.jsx)(s.pre,{children:(0,o.jsx)(s.code,{className:"language-sql",children:"SELECT * FROM srrisk.msgaccountriskrecordv5 WHERE accnt='T.ACCNT';\n"})}),"\n",(0,o.jsx)(i.B,{src:"/images/PlatformAPIs/SRSE/SRRisk/accountriskrecord.png",alt:"Account Risk Record"})]})}function m(e={}){let{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,o.jsx)(s,{...e,children:(0,o.jsx)(p,{...e})}):p(e)}},607591(e,s,n){n.d(s,{B:()=>r});var t=n(886070),o=n(830758);let r=({src:e,alt:s,className:n})=>{let[r,i]=(0,o.useState)(!1),a=()=>i(!1);return o.useEffect(()=>{let e=e=>{"Escape"===e.key&&a()};return r&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}},[r]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("img",{src:e,alt:s,className:`image-lightbox-thumbnail ${n||""}`,onClick:()=>i(!0),style:{cursor:"pointer"}}),r&&(0,t.jsx)("div",{className:"image-lightbox-overlay",onClick:a,children:(0,t.jsxs)("div",{className:"image-lightbox-content",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("button",{className:"image-lightbox-close",onClick:a,"aria-label":"Close",children:"\xd7"}),(0,t.jsx)("img",{src:e,alt:s,className:"image-lightbox-image"})]})})]})}},848193(e,s,n){n.d(s,{R:()=>i,x:()=>a});var t=n(830758);let o={},r=t.createContext(o);function i(e){let s=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),t.createElement(r.Provider,{value:s},e.children)}}}]);