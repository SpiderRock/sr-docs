<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Products/MLink/MLink" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.4.0">
<title data-rh="true">MLink API | SpiderRock Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.spiderrock.net/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://docs.spiderrock.net/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://docs.spiderrock.net/docs/Products/MLink/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="MLink API | SpiderRock Documentation"><meta data-rh="true" name="description" content="The SpiderRock MLink API provides access to live-data objects (real-time or delayed data feeds) within the SpiderRock system. This repo provides documentation and code samples for how developers can connect to MLink and consume the data returned."><meta data-rh="true" property="og:description" content="The SpiderRock MLink API provides access to live-data objects (real-time or delayed data feeds) within the SpiderRock system. This repo provides documentation and code samples for how developers can connect to MLink and consume the data returned."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.spiderrock.net/docs/Products/MLink/"><link data-rh="true" rel="alternate" href="https://docs.spiderrock.net/docs/Products/MLink/" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.spiderrock.net/docs/Products/MLink/" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="SpiderRock Documentation RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="SpiderRock Documentation Atom Feed"><link rel="stylesheet" href="/assets/css/styles.02509cde.css">
<script src="/assets/js/runtime~main.c0fad6c2.js" defer="defer"></script>
<script src="/assets/js/main.ac227598.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/srlogo.svg" alt="SpiderRock Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/srlogo.svg" alt="SpiderRock Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">SpiderRock Documentation</b></a><a class="navbar__item navbar__link" href="/docs/SRConnect/">SpiderRock Connect</a><a class="navbar__item navbar__link" href="/docs/Schemas/Schema/">Schemas</a><a class="navbar__item navbar__link" href="/docs/V8Migration/">V8 Migration</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/Products/">Products</a><a class="navbar__item navbar__link" href="/docs/Integration/">Integration</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/SpiderRock/SRConnect" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="SRConnect GitHub Repository"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Products/">Products Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Products/FIX/">FIX</a><button aria-label="Expand sidebar category &#x27;FIX&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/Products/MLink/">MLink API</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/Products/SRSE/">SRSE</a><button aria-label="Expand sidebar category &#x27;SRSE&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/Products/ToolSuite/">Tool Suite</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">MLink API</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>MLink API</h1>
<p>The SpiderRock MLink API provides access to live-data objects (real-time or delayed data feeds) within the SpiderRock system. This repo provides documentation and code samples for how developers can connect to MLink and consume the data returned.</p>
<p>MLink provides several options:</p>
<ul>
<li><a href="https://www.spiderrock.net/data/spiderstream-market-data-api/#dataproducts" target="_blank" rel="noopener noreferrer">6 product categories</a> to choose from, which are divided into 18 tokens for scoped access to message types</li>
<li>3 message delivery protocols: JSON, Framed JSON or Google Protocol Buffers</li>
<li>2 connection types: query-based (REST) or streaming (Websocket)</li>
<li>Real-time or delayed data</li>
<li>Authentication via API Key or Session Key</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="table-of-contents">Table of Contents<a class="hash-link" aria-label="Direct link to Table of Contents" title="Direct link to Table of Contents" href="/docs/Products/MLink/#table-of-contents">​</a></h2>
<ol>
<li>Authentication Methods</li>
<li>Messages</li>
<li>Connection Types</li>
</ol>
<h1>Authentication Methods</h1>
<p>You can authenticate to MLink through 2 different methods: Login or API Key</p>
<ol>
<li>
<p><strong>Login (Human Access)</strong>:
Use this method to authenticate your application by challenging humans to login with their SpiderRock ID credentials along with multi-factor authentication (MFA).</p>
<ul>
<li>
<p>The SpiderRock Support Desk will issue you a SpiderRock ID, by which you will receive an invitation to your registered email. From there, you will complete your setup and select with MFA method you want: Authenticator App or SMS. Upon completion of sign up you will have access to MLink as determined by your configuration.</p>
</li>
<li>
<p><strong>Session Keys:</strong> a Session Key looks similar to an API but is issued for each valid session after login. Therefore, once a user authenticates with their SpiderRock ID credentials their Session Key will be automatically issued and used for the remainer of the session.</p>
</li>
</ul>
</li>
<li>
<p><strong>API Key (Machine Access)</strong>:
Use this method to authenticate your application directly to MLink if there is no ability to use MFA or you only require a single data feed.</p>
<ul>
<li>
<p>The SpiderRock Support Desk will issue an <code>M2MUser</code> user as a datafeed profile, by which we will generate an API Key scoped to the permissions requested by the customer.</p>
</li>
<li>
<p><strong>Using an API Key via REST:</strong> Add your API Key to the querystring as &quot;apikey&quot;:
<code>https://mlink-live.nms.saturn.spiderrockconnect.com/rest/json?apikey=1234-5678-9012-31415</code></p>
</li>
<li>
<p><strong>Using an API Key via WebSocket:</strong> Send an MLinkLogon to MLink servers, then include <code>apikey</code> as a header in the initial HTTP handshake request:</p>
</li>
</ul>
</li>
</ol>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">msg = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;header&quot;: {&quot;mTyp&quot;: &quot;MLinkLogon&quot;},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;message&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;apiKey&quot;: &quot;1234-5678-9012-3141&quot; # Replace with actual API key or session key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    } </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> websockets</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">connect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">uriJson</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">extra_headers</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;Authorization&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Bearer {apikey}&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ping_timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> websocket</span><span class="token punctuation" style="color:#393A34">:</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h1>Messages</h1>
<p>In MLink, messages are organized and permissioned by the folllowing tokens:</p>
<table><thead><tr><th>Token</th><th>Description</th></tr></thead><tbody><tr><td>EqtMktData</td><td>Stock quote and prints</td></tr><tr><td>OptMktData</td><td>Options quote and prints</td></tr><tr><td>FutMktData</td><td>Futures quote and prints</td></tr><tr><td>SpreadMktData</td><td>Spread quote and markups</td></tr><tr><td>SpreadExchData</td><td>Live public spread orders for each exchange (if available)</td></tr><tr><td>EqtSummaryData</td><td>Stock market summaries</td></tr><tr><td>OptSummaryData</td><td>Options market summaries</td></tr><tr><td>FutSummaryData</td><td>Futures market summaries</td></tr><tr><td>EqtMarkData</td><td>Stock open and close marks</td></tr><tr><td>OptMarkData</td><td>Options open, close, surface, closing greeks marks</td></tr><tr><td>FutMarkData</td><td>Futures open, close and settlement marks</td></tr><tr><td>EqtExchImbalance</td><td>Stock market auction imbalances</td></tr><tr><td>OptSurface</td><td>Options surfaces, at-the-money volatility and related</td></tr><tr><td>OptAnalytics</td><td>Options implied quotes and risk slides</td></tr><tr><td>EquityDefinition</td><td>Production definitions for equities</td></tr><tr><td>OptionDefinition</td><td>Production definitions for options</td></tr><tr><td>FutureDefinition</td><td>Production definitions for futures</td></tr><tr><td>GlobalDefinition</td><td>Dividends, EarningsCalendars, Rates, StockBetas</td></tr><tr><td>MLinkWs</td><td>MLink WebSocket admin messages</td></tr><tr><td>MLinkRest</td><td>MLink HTTP/REST admin messages</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="message-patterns">Message Patterns<a class="hash-link" aria-label="Direct link to Message Patterns" title="Direct link to Message Patterns" href="/docs/Products/MLink/#message-patterns">​</a></h2>
<p>All MLink messages are generated from a common IDL schema and follow common patterns, including the following:</p>
<ol>
<li>
<p><strong>Live Data Objects with Primary Key:</strong></p>
<p>These messages have a well-defined primary key (unique per message type) and follow a create/replace pattern such that any new message arriving in MLink will completely replace the previous record with the same primary key, if one exists. NOTE: any REST query for this message pattern will result in the current, cached copy of all responsive records being returned to the client. An example of this pattern is the  &quot;NBBOOptionQuote&quot; message</p>
</li>
<li>
<p><strong>Security Keys:</strong></p>
<p>Several messages contain security keys (TickerKey, ExpiryKey, and/or OptionKey)</p>
<ul>
<li>TickerKey: <code>SSSS-TS-AT</code> where SSSS is the security symbol (eg. AAPL), TS is a ticker source (eg. NMS), and AT is a asset type (eg. EQT).</li>
<li>ExpiryKey: <code>SSSS-TS-AT-YYYY-MM-DD</code> where YYYY is year, MM is month, and DD is day.</li>
<li>OptionKey: <code>SSSS-TS-AT-YYYY-MM-DD-XXXX-CP</code> where XXXX is the strike price, and CP is either (Call, Put, or Both).</li>
</ul>
<p>Ticker Sources (ts) can be of the following:</p>
<ul>
<li>None=0,SR=1,NMS=2,CME=3,ICE=4,CFE=5,CBOT=6,NYMEX=7,COMEX=8,RUT=9,CIDX=10,ARCA=11,NYSE=12,OTC=13,NSDQ=14,MFQS=15,MIAX=16,DJI=17,CUSIP=18,ISIN=19</li>
</ul>
<p>Asset Types (at) can be of the following:</p>
<ul>
<li>None=0,EQT=1,IDX=2,BND=3,CUR=4,COM=5,FUT=6,SYN=7,WAR=8,FLX=9,MUT=10,SPD=11,MM=12,MF=13,COIN=14,TOKEN=15</li>
</ul>
</li>
<li>
<p><strong>Special Data Objects:</strong></p>
<ul>
<li>Spreads: <code>#SSSShhhh</code> where hhhh is a hexadecimal ID number. It is not possible to determine the security being traded without referring to the associated product definition.</li>
<li>FLEX: encoded as OptionKeys with the security symbol being the standard FLEX root.</li>
<li>Market Data: distributed with one of the above security keys where the symbol is the exchange trading symbol. Product definition records are available for all trading instruments that contain more complete details.</li>
<li>Synthetics: <code>_SSSS</code> or <code>SSSS_</code> computed for the purpose of pricing options more accurately (eg. multi-hedge basket underliers or roll+model derived options on futures quotes).</li>
</ul>
</li>
<li>
<p><strong>Admin Data Objects without Primary Keys:</strong></p>
<p>Some SR MLink objects do not have natural primary keys and are used as administrative messages between MLink and a client. An example of this pattern is &quot;MLinkLogon&quot;.</p>
</li>
<li>
<p><strong>HTTP/REST Admin Messages:</strong></p>
<table><thead><tr><th>Messages</th><th>Description</th></tr></thead><tbody><tr><td>MLinkApiKey</td><td>Used to return a temporary ApiKey (./getapikey)</td></tr><tr><td>QueryResult</td><td>Futures quote/print metrics (the last message in a response.body block) (./getmsg or ./getmsgs)</td></tr><tr><td>MsgDesc</td><td>Message Description (describes an SR message) (in response to ./getmsgtypes call)</td></tr><tr><td>FieldDesc</td><td>Field Description (schema) (in response to a ./getschema call)</td></tr><tr><td>SummaryNumeric</td><td>Summary detail for a numeric field (in response to a ./getsummary call)</td></tr><tr><td>SummaryString</td><td>Summary detail for a string field (in response to a ./getsummary call)</td></tr><tr><td>PostAck</td><td>Post acknowlegement for an individual SR message post attempt (./postmsgs)</td></tr></tbody></table>
</li>
<li>
<p><strong>MLink/WebSocket Admin Messages:</strong></p>
<table><thead><tr><th>Messages</th><th>Description</th></tr></thead><tbody><tr><td>MLinkAdmin</td><td>Sent in response to a WebSocket connect attempt and also in response to an MLinkLogon message</td></tr><tr><td>MLinkLogon</td><td>Used to logon (authenticate) (only required if credentials were not supplied in initial HTTP connect)</td></tr><tr><td>MLinkStream</td><td>Set or update the active subscription query for this session</td></tr><tr><td>MLinkStreamAck</td><td>Sent in repsponse to an MLinkStream attempt</td></tr><tr><td>MLinkStreamCheckPt</td><td>Query Check Point (None=0,Begin=1,Active=2,Complete=3,Replaced=4,Terminated=5)</td></tr><tr><td>MLinkSignalReady</td><td>Used to signal that the client is ready for more messages (live subscriptions w/o an active latency)</td></tr><tr><td>MLinkDataAck</td><td>Sent in response to an message upload attempt</td></tr><tr><td>MLinkSubscribe</td><td>Set or update an active subscription for a session by msgPKey</td></tr><tr><td>MLinkSubscribeAck</td><td>Sent in reponse to an MLinkSubscribe attempt</td></tr><tr><td>MLinkSubscribeCheckPt</td><td>Subscription Check Point (None=0,Begin=1,Active=2,Terminated=3)</td></tr><tr><td>MLinkHeartbeat</td><td>MLink Connection heart beat; sent by default every 10 seconds</td></tr></tbody></table>
</li>
</ol>
<h1>Connection Types</h1>
<p>You can connect to the MLink API through 2 different connection types: REST or Websocket.</p>
<ol>
<li>
<p>The <strong>REST API</strong> should be used for applications that need to query data from time to time, this connection type allows for more conservative message consumption which keeps costs lower.</p>
</li>
<li>
<p>The <strong>Websocket</strong> connection should be used for applications that require a live subscription to data, this connection type flows data to the screen automatically and tends to consume more messages as a result.</p>
</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-rest-api">1. REST API<a class="hash-link" aria-label="Direct link to 1. REST API" title="Direct link to 1. REST API" href="/docs/Products/MLink/#1-rest-api">​</a></h2>
<p>The MLink REST API is implemented as a standard HTTP/RESTful service accessible at:</p>
<ul>
<li>Real-time data - <a href="https://mlink-live.nms.saturn.spiderrockconnect.com/rest/" target="_blank" rel="noopener noreferrer">https://mlink-live.nms.saturn.spiderrockconnect.com/rest/</a></li>
<li>Delayed data - <a href="https://mlink-delay.nms.saturn.spiderrockconnect.com/rest/" target="_blank" rel="noopener noreferrer">https://mlink-delay.nms.saturn.spiderrockconnect.com/rest/</a></li>
</ul>
<p>Query parameters are URL-encoded and passed in the querystring. If successful, responses are sent back via the HTTP request body section. The URL also determines the protocol.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="protocol-usage">Protocol Usage<a class="hash-link" aria-label="Direct link to Protocol Usage" title="Direct link to Protocol Usage" href="/docs/Products/MLink/#protocol-usage">​</a></h3>
<ul>
<li>
<p><strong>JSON</strong> - Standard JSON</p>
<p>Query:</p>
<p><code>https://mlink-live.nms.saturn.spiderrockconnect.com/rest/json?apikey=&quot;your_api_key_token&quot;&amp;cmd=getmsg&amp;msgtype=OptionNbboQuote&amp;pkey=SPX-NMS-EQT-2024-03-15-4550-C</code></p>
<p>Response:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {&quot;header&quot;:{&quot;mTyp&quot;:&quot;OptionNbboQuote&quot;},&quot;message&quot;:{&quot;pkey&quot;:{&quot;okey&quot;:{&quot;at&quot;:&quot;EQT&quot;,&quot;ts&quot;:&quot;NMS&quot;,&quot;tk&quot;:&quot;SPX&quot;,&quot;dt&quot;:&quot;2024-03-15&quot;,&quot;xx&quot;:4550,&quot;cp&quot;:&quot;Call&quot;}},&quot;updateType&quot;:&quot;PrcChange&quot;,&quot;bidPrice&quot;:288.7,&quot;askPrice&quot;:292.2,&quot;bidSize&quot;:52,&quot;askSize&quot;:30,&quot;cumBidSize&quot;:52,&quot;cumAskSize&quot;:30,&quot;bidExch&quot;:&quot;CBOE&quot;,&quot;askExch&quot;:&quot;CBOE&quot;,&quot;bidMask&quot;:4,&quot;askMask&quot;:4,&quot;bidTime&quot;:31904651,&quot;askTime&quot;:31904651,&quot;srcTimestamp&quot;:1690379504651660288,&quot;netTimestamp&quot;:1690379504651853000}},</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {&quot;header&quot;:{&quot;mTyp&quot;:&quot;QueryResult&quot;},&quot;message&quot;:{&quot;numMessagesSent&quot;:1,&quot;queryElapsed&quot;:1.4089,&quot;result&quot;:&quot;Ok&quot;}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p><strong>Framed JSON</strong> - SpiderRock JSON with protobuf-like header. The framing header is a fixed length (14 bytes) and in the form: \r\nJMMMMMLLLLLL, where J is the protocol [J = framed json, P = protobuf], MMMMM is the message number (zero padded), and LLLLLL is the message length (zero padded).</p>
<p>Query:</p>
<p><code>https://mlink-live.nms.saturn.spiderrockconnect.com/rest/jsonf?apikey=&quot;your_api_key&quot;&amp;cmd=getmsg&amp;msgtype=OptionNbboQuote&amp;pkey=SPX-NMS-EQT-2024-03-15-4550-C</code></p>
<p>Response:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">J02785000423{&quot;header&quot;:{&quot;mTyp&quot;:&quot;OptionNbboQuote&quot;},&quot;message&quot;:{&quot;pkey&quot;:{&quot;okey&quot;:{&quot;at&quot;:&quot;EQT&quot;,&quot;ts&quot;:&quot;NMS&quot;,&quot;tk&quot;:&quot;SPX&quot;,&quot;dt&quot;:&quot;2024-03-15&quot;,&quot;xx&quot;:4550,&quot;cp&quot;:&quot;Call&quot;}},&quot;updateType&quot;:&quot;PrcChange&quot;,&quot;bidPrice&quot;:289.4,&quot;askPrice&quot;:291.9,&quot;bidSize&quot;:11,&quot;askSize&quot;:62,&quot;cumBidSize&quot;:11,&quot;cumAskSize&quot;:62,&quot;bidExch&quot;:&quot;CBOE&quot;,&quot;askExch&quot;:&quot;CBOE&quot;,&quot;bidMask&quot;:4,&quot;askMask&quot;:4,&quot;bidTime&quot;:31982946,&quot;askTime&quot;:31982592,&quot;srcTimestamp&quot;:1690379582946764032,&quot;netTimestamp&quot;:1690379582946960400}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">J03445000101{&quot;header&quot;:{&quot;mTyp&quot;:&quot;QueryResult&quot;},&quot;message&quot;:{&quot;numMessagesSent&quot;:1,&quot;queryElapsed&quot;:1.4177,&quot;result&quot;:&quot;Ok&quot;}}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p><strong>Protobuf</strong> - Google&#x27;s mechanism for serializing structured data, generally more efficient for processing higher bandwidth, lower-latency applications. See compilation notes below for usages. See above Framed JSON for header information.</p>
<p>Query:</p>
<p><code>https://mlink-live.nms.saturn.spiderrockconnect.com/rest/proto?apikey=&quot;your_api_key&quot;&amp;cmd=getmsg&amp;msgtype=OptionNbboQuote&amp;pkey=SPX-NMS-EQT-2024-03-15-4550-C</code></p>
<p>Response:</p>
<div class="language-cmd codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cmd codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">P02745000499&lt;OptionNbboQuote as protoBuf/binary message&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">P03320000111&lt;QueryResult as protoBuf/binary message&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Compiling SR proto files</strong></p>
<p><code>.proto</code> files exist in <a href="/proto_files/">SRMlink/proto_files</a>:</p>
<ul>
<li>spiderrock_common.proto</li>
<li>All Token .proto files for SpiderRock specific messages</li>
</ul>
<p>Both of these files need to be compiled to use <a href="https://protobuf.dev/overview/" target="_blank" rel="noopener noreferrer">protobuf</a> with MLink.</p>
<ul>
<li>To compile, first install the compiler, <a href="https://github.com/protocolbuffers/protobuf/releases/tag/v22.2" target="_blank" rel="noopener noreferrer">download the package</a> and follow the instructions in the README.</li>
<li>Then, run the compiler, specifying your application&#x27;s source directory (the current directory is used by default), the destination directory (where you want the generated code to go), and the path to your .proto file.</li>
</ul>
<p>For python, using python_out:</p>
<div class="language-cmd codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cmd codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">protoc -I=$SRC_DIR --python_out=$DST_DIR $SRC_DIR/[File].proto</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>In your specified destination, this will generate N .py files:</p>
<ul>
<li>spiderrock_common_pb2.py</li>
<li>&quot;Specific message&quot;_pb2.py</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rest-commands">REST Commands:<a class="hash-link" aria-label="Direct link to REST Commands:" title="Direct link to REST Commands:" href="/docs/Products/MLink/#rest-commands">​</a></h3>
<p>Query parameters are a set of key/value pairs (not case-sensitive):</p>
<table><thead><tr><th>Name</th><th>Parameter</th><th>Description</th></tr></thead><tbody><tr><td>cmd</td><td>c</td><td>c=&quot;command&quot; - the type of command, see list below</td></tr><tr><td>msgType</td><td>mt</td><td>mt=&quot;message type&quot; - either the string or numeric label of an SR Data Object class</td></tr><tr><td>pkey</td><td>pk</td><td>pk=&quot;primary key&quot; - a string representation of the primary key of a specific SR Data Object instance</td></tr><tr><td>limit</td><td>l</td><td>l=&quot;limit&quot; - a number between 1 and 10,000 and acts to limit the number of messages in the response body</td></tr><tr><td>secret</td><td>secret</td><td>secret=&quot;secret&quot; - the client-supplied API Password (if any) [only used with getapikey]</td></tr><tr><td>view</td><td>v</td><td>v=&quot;view clause&quot; - a string in the form of &quot;field1  field2  field3&quot;</td></tr><tr><td>where</td><td>w</td><td>w= &quot;where clause&quot; - a string in the form &quot;field1:eq<!-- -->:value<!-- -->&quot; or &quot;(field1:ne<!-- -->:value1<!-- --> &amp; field1:ne<!-- -->:value2<!-- -->)</td></tr><tr><td>order</td><td>order</td><td>(optional) order clause eg. &quot;(bidsize<!-- -->:DESC<!-- --> | bidexch<!-- -->:ASC<!-- --> | bidprice:DESC<!-- -->:ABS<!-- --> | askprice:ASC<!-- -->:ABS<!-- -->&quot;  (default is unordered; default is faster)</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="commands">Commands:<a class="hash-link" aria-label="Direct link to Commands:" title="Direct link to Commands:" href="/docs/Products/MLink/#commands">​</a></h4>
<table><thead><tr><th>Command</th><th>Description</th><th>Parameters</th></tr></thead><tbody><tr><td>getapikey</td><td>creates/updates MLink API key</td><td>secret</td></tr><tr><td>getmsgtypes</td><td>returns all available message types</td><td>view, where</td></tr><tr><td>getschema</td><td>returns a single message schema</td><td>msgType, view</td></tr><tr><td>getmsg</td><td>returns a single message by PrimaryKey</td><td>msgType, pkey, view</td></tr><tr><td>getmsgs</td><td>returns all available messages for a message type</td><td>msgtype, pkey, limit, view, where, order</td></tr><tr><td>getaggregate</td><td>returns summarized or aggregated data based on specified criteria</td><td>msgtype, group, measure</td></tr><tr><td>getcount</td><td>returns the count of records for a message type</td><td>msgType, where</td></tr></tbody></table>
<p>&quot;WHERE&quot; clauses can contain the following comparison symbols:</p>
<ul>
<li>:gt: is greater than</li>
<li>:ge: is greater than or equal to</li>
<li>:lt: is less than</li>
<li>:le: is less than or equal to</li>
<li>:eq: is equal</li>
<li>:ne: is not equal</li>
<li>%26 is an AND statement</li>
<li>| is an OR statement</li>
<li>:sw: is starts with</li>
<li>:ew: is ends with</li>
<li>:cv: is contains values</li>
<li>:nv: is does not contain value</li>
<li>:cb: is contained between (two dates for instance) separated by &#x27;$&#x27;</li>
</ul>
<p>&quot;getAggregate&quot; takes in both group and measure with a msgType:</p>
<ul>
<li>
<p>Group types can be the following; examples:
Numeric Quantile: <code>{ &quot;cmd&quot;, &quot;getaggregate&quot; }, { &quot;msgtype&quot;, &quot;OptionNbboQuote&quot; }, { &quot;group&quot;, &quot;bidprice:Q:9&quot; }, { &quot;measure&quot;, &quot;bidprice&quot; }</code></p>
<p>Numeric Range: <code>{ &quot;cmd&quot;, &quot;getaggregate&quot; },{ &quot;msgtype&quot;, &quot;OptionNbboQuote&quot; },{ &quot;group&quot;, &quot;bidprice:RANGE:3&quot; }, { &quot;measure&quot;, &quot;bidprice&quot; }</code></p>
<p>DateTimeRange: <code>{ &quot;cmd&quot;, &quot;getaggregate&quot; }, { &quot;msgtype&quot;, &quot;OptionPrint&quot; },{ &quot;group&quot;, $&quot;timestamp:TIMEHIST:3#STARTDATE#ENDDATE&quot; },{ &quot;measure&quot;, &quot;prtprice&quot; }</code></p>
<p>String Top N: <code>{ &quot;cmd&quot;, &quot;getaggregate&quot; }, { &quot;msgtype&quot;, &quot;OptionNbboQuote&quot; }, { &quot;group&quot;, &quot;bidexch:top:3&quot; }, { &quot;measure&quot;, &quot;bidprice|askprice|bidsize|asksize&quot; }</code></p>
</li>
<li>
<p>You can set measureTypes in group parameters such that:
<code>{ &quot;cmd&quot;, &quot;getaggregate&quot; }, { &quot;msgtype&quot;, &quot;OptionNbboQuote&quot; }, { &quot;group&quot;, &quot;bidexch:top:3:asksize:max&quot; }, { &quot;measure&quot;, &quot;bidprice|askprice|bidsize|asksize&quot;}</code></p>
</li>
</ul>
<p>Note that measureTypes can be of cnt, min, max, sum, avg</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rest-examples">Rest Examples<a class="hash-link" aria-label="Direct link to Rest Examples" title="Direct link to Rest Examples" href="/docs/Products/MLink/#rest-examples">​</a></h3>
<p>Obtain your session Key (first needs UserName, PassWord, and MFA):</p>
<p><code>https://mlink-live.nms.saturn.spiderrockconnect.com/rest/json?cmd=logon&amp;user=USERNAME&amp;pw=PASSWORD&amp;pin=MFA_CODE</code></p>
<p>Get all messages available:</p>
<p><code>https://mlink-live.nms.saturn.spiderrockconnect.com/rest/json?apikey=&quot;your_api_key_token&quot;&amp;cmd=getmsgtypes</code></p>
<p>Get field definitions for a message:</p>
<p><code>https://mlink-live.nms.saturn.spiderrockconnect.com/rest/json?apikey=&quot;your_api_key_token&quot;&amp;cmd=getschema&amp;msgtype=OptionNbboQuote</code></p>
<p>Filtering for an Option Key:</p>
<p><code>https://mlink-live.nms.saturn.spiderrockconnect.com/rest/json?apikey=&quot;your_api_key_token&quot;&amp;cmd=getmsgs&amp;msgtype=OptionNbboQuote&amp;where=okey:eq:SPX-NMS-EQT-2024-03-15-4550-C</code></p>
<p>Filtering for a Ticker Key:</p>
<p><code>https://mlink-live.nms.saturn.spiderrockconnect.com/rest/json?apikey=&quot;your_api_key_token&quot;&amp;cmd=getmsgs&amp;msgtype=StockBookQuote&amp;where=ticker:eq:AAPL-NMS-EQT</code></p>
<p>or</p>
<p><code>https://mlink-live.nms.saturn.spiderrockconnect.com/rest/json?apikey=&quot;your_api_key_token&quot;&amp;cmd=getmsgs&amp;msgtype=OptionNbboQuote&amp;where=okey.tk:eq:AAPL</code></p>
<p>Filtering by a View:</p>
<p><code>https://mlink-live.nms.saturn.spiderrockconnect.com/rest/json?apikey=&quot;your_api_key_token&quot;&amp;cmd=getmsgs&amp;msgtype=OptionNbboQuote&amp;view=okey|bidprice|askprice</code></p>
<p>Complex filtering:</p>
<p><code>https://mlink-live.nms.saturn.spiderrockconnect.com/rest/json?apikey=&quot;your_api_key_token&quot;&amp;cmd=getmsgs&amp;msgtype=OptionNbboQuote&amp;where=(bidsize:eq:1%26asksize:eq:1)|(bidsize:eq:10%26asksize:eq:1)&amp;view=okey|bidprice|askprice|asksize|bidsize</code></p>
<p>Complex Primary Keys:</p>
<p><code>https://mlink-live.nms.saturn.spiderrockconnect.com/rest/json?apikey=&quot;your_api_key_token&quot;&amp;cmd=getmsg&amp;msgtype=LiveSurfaceCurve&amp;pkey=AAPL-NMS-EQT-2023-12-01|Live</code></p>
<ul>
<li>Note that in this example the pkey is a repeater with en Expiry Key + SurfaceType</li>
</ul>
<p>Simple getAggregate:</p>
<p><code>https://mlink-live.nms.saturn.spiderrockconnect.com/rest/json?apikey=&quot;your_api_key_token&quot;&amp;cmd=getaggregate&amp;msgtype=OptionNbboQuote&amp;measure=bidprice|askprice|bidsize|asksize</code></p>
<p>GetAggregate by Bid Exchange:</p>
<p><code>https://mlink-live.nms.saturn.spiderrockconnect.com/rest/json?apikey=&quot;your_api_key_token&quot;&amp;cmd=getaggregate&amp;msgtype=OptionNbboQuote&amp;group=bidexch&amp;measure=bidprice|askprice|bidsize|asksize</code></p>
<p>GetAggregate by Bid Exchange Top3:</p>
<p><code>https://mlink-live.nms.saturn.spiderrockconnect.com/rest/json?apikey=&quot;your_api_key_token&quot;&amp;cmd=getaggregate&amp;msgtype=OptionNbboQuote&amp;group=bidexch:top:3&amp;measure=bidprice|askprice|bidsize|asksize</code></p>
<p>GetAggregate by bidPrice Range:</p>
<p><code>https://mlink-live.nms.saturn.spiderrockconnect.com/rest/json?apikey=&quot;your_api_key_token&quot;&amp;cmd=getaggregate&amp;msgtype=OptionNbboQuote&amp;group=bidprice:RANGE:3&amp;measure=bidprice</code></p>
<p>GetAggregate complex:</p>
<p><code>https://mlink-live.nms.saturn.spiderrockconnect.com/rest/json?apikey=&quot;your_api_key_token&quot;&amp;cmd=getaggregate&amp;msgtype=OptionPrint&amp;group=timestamp:TRANGE:3&amp;measure=prtsize&amp;where=timestamp:cb:value1$value2</code></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-websocket-api">2. Websocket API<a class="hash-link" aria-label="Direct link to 2. Websocket API" title="Direct link to 2. Websocket API" href="/docs/Products/MLink/#2-websocket-api">​</a></h2>
<p>The MLink Websocket API is implemented as a standard HTTP WebSocket service accessible at:</p>
<ul>
<li>Real-time data - wss://mlink-live.nms.saturn.spiderrockconnect.com/mlink/</li>
<li>Delayed data - wss://mlink-delay.nms.saturn.spiderrockconnect.com/mlink/</li>
</ul>
<p>Query parameters are URL-encoded and passed in the querystring. If successful, responses are sent back via the HTTP request body section. The URL also determines the protocol.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="websocket-parameters---mlinkstream">Websocket Parameters - MLinkStream:<a class="hash-link" aria-label="Direct link to Websocket Parameters - MLinkStream:" title="Direct link to Websocket Parameters - MLinkStream:" href="/docs/Products/MLink/#websocket-parameters---mlinkstream">​</a></h3>
<table><thead><tr><th>Field Name</th><th>Field Type</th><th>Description</th></tr></thead><tbody><tr><td>msgName</td><td>MessageTypeName</td><td>(optional) message name</td></tr><tr><td>view</td><td>string</td><td>(optional) list (subset) of field names to return with this message (eg. bidprice|askprice|bidsize|asksize) (default is all names)</td></tr><tr><td>where</td><td>string</td><td>(optional) where clause for this message type; eg. &quot;(bidexch:eq<!-- -->:CBOE<!-- -->) &amp; bidsize:ge:100&quot;  (default is all records) any field in the message requested can be used</td></tr><tr><td>unsubscribe</td><td>enum<!-- -->:YesNo</td><td>(optional) if set to Yes the specified message type will be unsubscribed and thus no longer return</td></tr><tr><td>sessionID</td><td>short</td><td>(optional) actions below apply only to the sessionID virtual session; should be zero for non-multiplexed web-socket connections.</td></tr><tr><td>queryID</td><td>GroupingCode</td><td>(optional) queryID will be reflected back in the corresponding MLinkStreamAck message; nothing is assumed about structure of this number</td></tr><tr><td>queryLabel</td><td>AppNameString</td><td>query label</td></tr><tr><td>activeLatency</td><td>int</td><td>(optional) number of milliseconds between active send attempts (1 = minimum delay, 0 = wait for SignalReady) [default = 0]</td></tr><tr><td>sysEnvironment</td><td>enum</td><td>(optional) records cannot have [sysEnvironment + sysRealm] in their route history (no loops)</td></tr><tr><td>sysRealm</td><td>enum</td><td></td></tr><tr><td>highwaterTs</td><td>long</td><td>(optional) records must have a header.sentTs that is later than this value (ns after the UNIX epoch)  -1 means start from current server side highwaterTs</td></tr><tr><td>stripeFilter</td><td>text1</td><td>(optional) if supplied records must be within the specified stripe</td></tr><tr><td>schemaHash</td><td>long</td><td>(optional) message schema hash [if supplied and matches server schema hash for this message binary encoding will be used]</td></tr><tr><td>localMsgType</td><td>ushort</td><td>(optional) if != 0 the msgType number will be translated from msgType to localMsgType in the mlink server (binary messages)</td></tr><tr><td>localMsgName</td><td>MessageTypeName</td><td>(optional) if exists the message name will be translated from msgName to localMsgName in the mlink server (json and protobuf messages)</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="websocket-parameters---mlinksubscribe">Websocket Parameters - MLinkSubscribe:<a class="hash-link" aria-label="Direct link to Websocket Parameters - MLinkSubscribe:" title="Direct link to Websocket Parameters - MLinkSubscribe:" href="/docs/Products/MLink/#websocket-parameters---mlinksubscribe">​</a></h3>
<table><thead><tr><th>Field Name</th><th>Field Type</th><th>Description</th></tr></thead><tbody><tr><td>sessionID</td><td>short</td><td>(optional) actions below apply only to the sessionID virtual session; should be zero for non-multiplexed web-socket connections.</td></tr><tr><td>SubscribeID</td><td>GroupingCode</td><td>(optional) subscribeD will be reflected back in the corresponding MLinkSubscribeAck message; nothing is assumed about structure of this number</td></tr><tr><td>activeLatency</td><td>int</td><td>(optional) number of milliseconds between active send attempts (1 = minimum delay, 0 = wait for SignalReady) [default = 0]</td></tr><tr><td>compression</td><td>enum</td><td>(optional) FieldChangesOnly will supress fields in messages that have not changed since the previous send (resets automatically after every subscription) None=0,FieldChangesOnly=1</td></tr><tr><td>doReset</td><td>enum<!-- -->:YesNo</td><td>if Yes all current subscriptions will be removed prior to applying the actions below</td></tr><tr><td>View</td><td></td><td></td></tr><tr><td>msgName</td><td>msgTypeName</td><td>a SpiderRock message name (topic channel) (can be string name or protobuf message number)</td></tr><tr><td>view</td><td>string</td><td>list (subset) of field names to return with this message type (eg. bidprice|askprice|bidsize|asksize)</td></tr><tr><td>Subscribe</td><td></td><td></td></tr><tr><td>msgName</td><td>msgTypeName</td><td>a SpiderRock message name (topic channel) (can be string name or protobuf message number)</td></tr><tr><td>msgPKey</td><td>string</td><td>an existing message.pkey; can be in either flat string or JSON format; if missing/empty all active msgName subscriptions will be removed</td></tr><tr><td>highwterTs</td><td>Long</td><td>(optional) records must have a header.sentTs that is later than this value (nanoseconds after the UNIX epoch) -1 means start from current server side highwaterTs</td></tr><tr><td>Unsubscribe</td><td></td><td></td></tr><tr><td>msgName</td><td>msgTypeName</td><td>a SpiderRock message name (topic channel) (can be string name or protobuf message number)</td></tr><tr><td>msgPKey</td><td>string</td><td>an existing message.pkey; can be in either flat string or JSON format; if missing/empty all active msgName subscriptions will be removed</td></tr></tbody></table>
<p>Upon opening up a WebSocket connection to MLink, Authenticating, and requesting to stream a message (msgName) with user specified conditions (view, where, etc), the MLinkServer will initially clear cache. This means it will forward the latest updates to all of the primary keys in your message before it starts streaming.</p>
<p>Clients have the possibilitiy to determine when cache has been cleared using the MLinkAdmin messages:</p>
<ul>
<li>Initially, upon authentication MLinkServers will send an <em><strong>MLinkAdmin</strong></em> with the authentication state</li>
<li>MLinkServers will then send an Acknowledgement message of type <em><strong>MLinkStreamAck</strong></em> to acknowledge reception of the message request.</li>
<li>A first checkpoint  <em><strong>MLinkStreamCheckPt</strong></em> is then sent with a message body state of begin (begin to clear cache)</li>
<li>MLinkServers send the cached records</li>
<li>A secondary checkpoint <em><strong>MLinkStreamCheckPt</strong></em> is then sent with a message body state of Active (request is active)</li>
<li>The state.Active <em><strong>MLinkStreamCheckPt</strong></em> is followed by another <em><strong>MLinkStreamCheckPt</strong></em> with a message body state of Complete to alert the client side that cache has cleared</li>
<li>MLink is now streaming.</li>
</ul>
<p>Below is an example of streaming the following request, AMZN stock quote:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">msg = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        &quot;header&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            &quot;mTyp&quot;:&quot;MLinkStream&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        &quot;message&quot;: { </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            &quot;queryLabel&quot;:&quot;ExampleStockBookQuote&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            &quot;activeLatency&quot;: 1,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            &quot;msgName&quot;:&quot;stockbookquote&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            &quot;where&quot;:&quot;ticker.tk:eq:AMZN&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="reponse-order">Reponse Order:<a class="hash-link" aria-label="Direct link to Reponse Order:" title="Direct link to Reponse Order:" href="/docs/Products/MLink/#reponse-order">​</a></h4>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-json codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{&#x27;header&#x27;: {&#x27;mTyp&#x27;: &#x27;MLinkAdmin&#x27;, &#x27;sEnv0&#x27;: &#x27;Saturn&#x27;, &#x27;sRlm0&#x27;: &#x27;NMS&#x27;, &#x27;sID&#x27;: 0, &#x27;kLen&#x27;: 0, &#x27;mLen&#x27;: 0, &#x27;seqN&#x27;: 0, &#x27;appN&#x27;: &#x27;MLinkServer.Prod.B.Extern&#x27;, &#x27;mn&#x27;: &#x27;SROCKNY5-130&#x27;, &#x27;sTim&#x27;: &#x27;2023-11-09 15:26:23.464116&#x27;, &#x27;encT&#x27;: &#x27;2023-11-09 15:26:23.464120&#x27;, &#x27;git&#x27;: &#x27;b981c14047&#x27;}, &#x27;message&#x27;: {&#x27;state&#x27;: &#x27;LoggedOn&#x27;}} </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&#x27;header&#x27;: {&#x27;mTyp&#x27;: &#x27;MLinkStreamAck&#x27;, &#x27;sEnv0&#x27;: &#x27;Saturn&#x27;, &#x27;sRlm0&#x27;: &#x27;NMS&#x27;, &#x27;sID&#x27;: 0, &#x27;kLen&#x27;: 0, &#x27;mLen&#x27;: 0, &#x27;seqN&#x27;: 0, &#x27;appN&#x27;: &#x27;MLinkServer.Prod.B.Extern&#x27;, &#x27;mn&#x27;: &#x27;SROCKNY5-130&#x27;, &#x27;sTim&#x27;: &#x27;2023-11-09 15:26:23.573021&#x27;, &#x27;encT&#x27;: &#x27;2023-11-09 15:26:23.573023&#x27;, &#x27;git&#x27;: &#x27;b981c14047&#x27;}, &#x27;message&#x27;: {&#x27;msgName&#x27;: &#x27;stockbookquote&#x27;, &#x27;result&#x27;: &#x27;OK&#x27;}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&#x27;header&#x27;: {&#x27;mTyp&#x27;: &#x27;MLinkStreamCheckPt&#x27;, &#x27;sEnv0&#x27;: &#x27;Saturn&#x27;, &#x27;sRlm0&#x27;: &#x27;NMS&#x27;, &#x27;sID&#x27;: 0, &#x27;kLen&#x27;: 0, &#x27;mLen&#x27;: 0, &#x27;seqN&#x27;: 0, &#x27;appN&#x27;: &#x27;MLinkServer.Prod.B.Extern&#x27;, &#x27;mn&#x27;: &#x27;SROCKNY5-130&#x27;, &#x27;sTim&#x27;: &#x27;2023-11-09 15:26:23.573034&#x27;, &#x27;encT&#x27;: &#x27;2023-11-09 15:26:23.573035&#x27;, &#x27;git&#x27;: &#x27;b981c14047&#x27;}, &#x27;message&#x27;: {&#x27;state&#x27;: &#x27;Begin&#x27;, &#x27;timestamp&#x27;: &#x27;2023-11-09 15:26:23.566996&#x27;}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&#x27;header&#x27;: {&#x27;mTyp&#x27;: &#x27;StockBookQuote&#x27;, &#x27;sEnv0&#x27;: &#x27;Saturn&#x27;, &#x27;sRlm0&#x27;: &#x27;NMS&#x27;, &#x27;sID&#x27;: 18409, &#x27;kLen&#x27;: 0, &#x27;mLen&#x27;: 0, &#x27;seqN&#x27;: 206, &#x27;appN&#x27;: &#x27;MLinkServer.Prod.B.Extern&#x27;, &#x27;mn&#x27;: &#x27;SROCKNY5-130&#x27;, &#x27;sTim&#x27;: &#x27;2023-11-09 15:26:29.699590&#x27;, &#x27;encT&#x27;: &#x27;2023-11-09 15:26:29.707677&#x27;, &#x27;git&#x27;: &#x27;b981c14047&#x27;}, &#x27;message&#x27;: {&#x27;pkey&#x27;: {&#x27;ticker&#x27;: {&#x27;at&#x27;: &#x27;EQT&#x27;, &#x27;ts&#x27;: &#x27;NMS&#x27;, &#x27;tk&#x27;: &#x27;AMZN&#x27;}}, &#x27;updateType&#x27;: &#x27;PrcChange&#x27;, &#x27;marketStatus&#x27;: &#x27;Open&#x27;, &#x27;bidPrice1&#x27;: 141.69, &#x27;bidSize1&#x27;: 9, &#x27;bidExch1&#x27;: &#x27;EDGX&#x27;, &#x27;bidMask1&#x27;: 18240, &#x27;askPrice1&#x27;: 141.7, &#x27;askSize1&#x27;: 1, &#x27;askExch1&#x27;: &#x27;MPRL&#x27;, &#x27;bidPrice2&#x27;: 141.68, &#x27;bidSize2&#x27;: 1, &#x27;bidExch2&#x27;: &#x27;IEX&#x27;, &#x27;askPrice2&#x27;: 141.71, &#x27;askSize2&#x27;: 8, &#x27;askExch2&#x27;: &#x27;EDGX&#x27;, &#x27;askMask2&#x27;: 18240, &#x27;srcTimestamp&#x27;: 1699543589698404599, &#x27;netTimestamp&#x27;: 1699543589698443200}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&#x27;header&#x27;: {&#x27;mTyp&#x27;: &#x27;MLinkStreamCheckPt&#x27;, &#x27;sEnv0&#x27;: &#x27;Saturn&#x27;, &#x27;sRlm0&#x27;: &#x27;NMS&#x27;, &#x27;sID&#x27;: 0, &#x27;kLen&#x27;: 0, &#x27;mLen&#x27;: 0, &#x27;seqN&#x27;: 0, &#x27;appN&#x27;: &#x27;MLinkServer.Prod.B.Extern&#x27;, &#x27;mn&#x27;: &#x27;SROCKNY5-130&#x27;, &#x27;sTim&#x27;: &#x27;2023-11-09 15:26:23.573034&#x27;, &#x27;encT&#x27;: &#x27;2023-11-09 15:26:45.596555&#x27;, &#x27;git&#x27;: &#x27;b981c14047&#x27;}, &#x27;message&#x27;: {&#x27;state&#x27;: &#x27;Active&#x27;, &#x27;numMessagesSent&#x27;: 1, &#x27;timestamp&#x27;: &#x27;2023-11-09 15:26:45.592286&#x27;}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&#x27;header&#x27;: {&#x27;mTyp&#x27;: &#x27;MLinkStreamCheckPt&#x27;, &#x27;sEnv0&#x27;: &#x27;Saturn&#x27;, &#x27;sRlm0&#x27;: &#x27;NMS&#x27;, &#x27;sID&#x27;: 0, &#x27;kLen&#x27;: 0, &#x27;mLen&#x27;: 0, &#x27;seqN&#x27;: 0, &#x27;appN&#x27;: &#x27;MLinkServer.Prod.B.Extern&#x27;, &#x27;mn&#x27;: &#x27;SROCKNY5-130&#x27;, &#x27;sTim&#x27;: &#x27;2023-11-09 15:26:23.573034&#x27;, &#x27;encT&#x27;: &#x27;2023-11-09 15:26:45.596582&#x27;, &#x27;git&#x27;: &#x27;b981c14047&#x27;}, &#x27;message&#x27;: {&#x27;state&#x27;: &#x27;Complete&#x27;, &#x27;waitElapsed&#x27;: -22.0229465, &#x27;queryElapsed&#x27;: 22.0229815, &#x27;tryFwdElapsed&#x27;: -1.5e-05, &#x27;flushElapsed&#x27;: 1.5e-05, &#x27;timestamp&#x27;: &#x27;2023-11-09 15:26:45.592286&#x27;}}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">{&#x27;header&#x27;: {&#x27;mTyp&#x27;: &#x27;StockBookQuote&#x27;, &#x27;sEnv0&#x27;: &#x27;Saturn&#x27;, &#x27;sRlm0&#x27;: &#x27;NMS&#x27;, &#x27;sID&#x27;: 18409, &#x27;kLen&#x27;: 0, &#x27;mLen&#x27;: 0, &#x27;seqN&#x27;: 93, &#x27;appN&#x27;: &#x27;MLinkServer.Prod.B.Extern&#x27;, &#x27;mn&#x27;: &#x27;SROCKNY5-130&#x27;, &#x27;sTim&#x27;: &#x27;2023-11-09 15:26:47.543689&#x27;, &#x27;encT&#x27;: &#x27;2023-11-09 15:26:47.611402&#x27;, &#x27;git&#x27;: &#x27;b981c14047&#x27;}, &#x27;message&#x27;: {&#x27;pkey&#x27;: {&#x27;ticker&#x27;: {&#x27;at&#x27;: &#x27;EQT&#x27;, &#x27;ts&#x27;: &#x27;NMS&#x27;, &#x27;tk&#x27;: &#x27;AMZN&#x27;}}, &#x27;updateType&#x27;: &#x27;PrcChange&#x27;, &#x27;marketStatus&#x27;: &#x27;Open&#x27;, &#x27;bidPrice1&#x27;: 141.64, &#x27;bidSize1&#x27;: 22, &#x27;bidExch1&#x27;: &#x27;EDGX&#x27;, &#x27;bidMask1&#x27;: 18240, &#x27;askPrice1&#x27;: 141.66, &#x27;askSize1&#x27;: 18, &#x27;askExch1&#x27;: &#x27;EDGX&#x27;, &#x27;askMask1&#x27;: 18240, &#x27;bidPrice2&#x27;: 141.62, &#x27;bidSize2&#x27;: 1, &#x27;bidExch2&#x27;: &#x27;IEX&#x27;, &#x27;askPrice2&#x27;: 141.71, &#x27;askSize2&#x27;: 1, &#x27;askExch2&#x27;: &#x27;PSX&#x27;, &#x27;askMask2&#x27;: 4096, &#x27;srcTimestamp&#x27;: 1699543607542434826, &#x27;netTimestamp&#x27;: 1699543607542516100}}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="mlink-stripes">MLink Stripes<a class="hash-link" aria-label="Direct link to MLink Stripes" title="Direct link to MLink Stripes" href="/docs/Products/MLink/#mlink-stripes">​</a></h3>
<p>MLinkStream allows users to stripe their connections based on pre-defined sets of tickers (tk), indexes, or exchanges (ts) in order to either balance the load on the receiving end and/or segment (stripes correspond to different sets of assets). This is especially useful if you are trying to distribute the incoming message load, or are interested in tickers within specific stripes. An example of striped connections (1 Stripe = 1 WebSocket connection) can be found here: MLink-Samples\client-python\JSONFramed\examples\clientStripes.py</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="native-opra--nms-stripes-eqt">Native OPRA / NMS Stripes (EQT)<a class="hash-link" aria-label="Direct link to Native OPRA / NMS Stripes (EQT)" title="Direct link to Native OPRA / NMS Stripes (EQT)" href="/docs/Products/MLink/#native-opra--nms-stripes-eqt">​</a></h4>
<table><thead><tr><th>Stripe</th><th>startTicker</th><th>endTicker</th></tr></thead><tbody><tr><td>A1</td><td>A</td><td>AMZN</td></tr><tr><td>A2</td><td>AMZN</td><td>COIN</td></tr><tr><td>B1</td><td>COIN</td><td>ENQZZ</td></tr><tr><td>B2</td><td>ENQZZ</td><td>GOOGL</td></tr><tr><td>C1</td><td>GOOGLE</td><td>IWM</td></tr><tr><td>C2</td><td>IWM</td><td>LRCX</td></tr><tr><td>D1</td><td>LRCX</td><td>METAA</td></tr><tr><td>D2</td><td>METAA</td><td>NFLX</td></tr><tr><td>E1</td><td>NFLX</td><td>NVDA</td></tr><tr><td>E2</td><td>NVDA</td><td>NVDAA</td></tr><tr><td>F1</td><td>NVDAA</td><td>QQQ</td></tr><tr><td>F2</td><td>QQQ</td><td>QQQA</td></tr><tr><td>G1</td><td>QQQA</td><td>SPY</td></tr><tr><td>G2</td><td>SPY</td><td>SPYA</td></tr><tr><td>H1</td><td>SPYA</td><td>TSLAA</td></tr><tr><td>H2</td><td>TSLAA</td><td>ZZZZZZ</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="compound-opra--nms-stripes-eqt">Compound OPRA / NMS Stripes (EQT)<a class="hash-link" aria-label="Direct link to Compound OPRA / NMS Stripes (EQT)" title="Direct link to Compound OPRA / NMS Stripes (EQT)" href="/docs/Products/MLink/#compound-opra--nms-stripes-eqt">​</a></h4>
<table><thead><tr><th>Stripe</th><th>Start Stripe</th><th>End Stripe</th></tr></thead><tbody><tr><td>A</td><td>A1</td><td>A2</td></tr><tr><td>B</td><td>B1</td><td>B2</td></tr><tr><td>C</td><td>C1</td><td>C2</td></tr><tr><td>D</td><td>D1</td><td>D2</td></tr><tr><td>E</td><td>E1</td><td>E2</td></tr><tr><td>F</td><td>F1</td><td>F2</td></tr><tr><td>G</td><td>G1</td><td>G2</td></tr><tr><td>H</td><td>H1</td><td>H2</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="index-source-stripes">Index Source Stripes<a class="hash-link" aria-label="Direct link to Index Source Stripes" title="Direct link to Index Source Stripes" href="/docs/Products/MLink/#index-source-stripes">​</a></h4>
<table><thead><tr><th>Stripe</th><th>Ticker Source</th></tr></thead><tbody><tr><td>I1</td><td>CDIX</td></tr><tr><td>I2</td><td>DJI</td></tr><tr><td>I3</td><td>RUT</td></tr><tr><td>I4</td><td>MIAX</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="coumpound-index-source-stripe">Coumpound Index Source Stripe<a class="hash-link" aria-label="Direct link to Coumpound Index Source Stripe" title="Direct link to Coumpound Index Source Stripe" href="/docs/Products/MLink/#coumpound-index-source-stripe">​</a></h4>
<table><thead><tr><th>Stripe</th><th>Ticker Source</th></tr></thead><tbody><tr><td>I</td><td>I1<!-- -->:I4</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="otc--mutual-fund--other-source-stripes">OTC / Mutual Fund / Other Source Stripes<a class="hash-link" aria-label="Direct link to OTC / Mutual Fund / Other Source Stripes" title="Direct link to OTC / Mutual Fund / Other Source Stripes" href="/docs/Products/MLink/#otc--mutual-fund--other-source-stripes">​</a></h4>
<table><thead><tr><th>Stripe</th><th>Ticker Source</th></tr></thead><tbody><tr><td>J1</td><td>OTC</td></tr><tr><td>J2</td><td>MFQS</td></tr><tr><td>J3</td><td>CUSIP</td></tr><tr><td>J4</td><td>ISIN</td></tr><tr><td>J5</td><td>SR</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="coumpound-otc--mutual-fund--other-source-stripe">Coumpound OTC / Mutual Fund / Other Source Stripe<a class="hash-link" aria-label="Direct link to Coumpound OTC / Mutual Fund / Other Source Stripe" title="Direct link to Coumpound OTC / Mutual Fund / Other Source Stripe" href="/docs/Products/MLink/#coumpound-otc--mutual-fund--other-source-stripe">​</a></h4>
<table><thead><tr><th>Stripe</th><th>Ticker Source</th></tr></thead><tbody><tr><td>J</td><td>J1<!-- -->:J4</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="market-indexes-stripes">Market Indexes Stripes<a class="hash-link" aria-label="Direct link to Market Indexes Stripes" title="Direct link to Market Indexes Stripes" href="/docs/Products/MLink/#market-indexes-stripes">​</a></h4>
<table><thead><tr><th>Stripe</th><th>Tickers</th></tr></thead><tbody><tr><td>M1</td><td>NDX,NDXP,RUT,RUTW,MRUT</td></tr><tr><td>M2</td><td>SPY, VXX</td></tr><tr><td>M3</td><td>QQQ</td></tr><tr><td>M4</td><td>IWM</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="compound-market-indexes-stripe">Compound Market Indexes Stripe<a class="hash-link" aria-label="Direct link to Compound Market Indexes Stripe" title="Direct link to Compound Market Indexes Stripe" href="/docs/Products/MLink/#compound-market-indexes-stripe">​</a></h4>
<table><thead><tr><th>Stripe</th><th>Tickers</th></tr></thead><tbody><tr><td>M</td><td>M1<!-- -->:M4</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="spx-stripe">SPX Stripe<a class="hash-link" aria-label="Direct link to SPX Stripe" title="Direct link to SPX Stripe" href="/docs/Products/MLink/#spx-stripe">​</a></h4>
<table><thead><tr><th>Stripe</th><th>Tickers</th></tr></thead><tbody><tr><td>S</td><td>SPX,SPXW,XSP,VIX,VIXW</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="gth-stripes">GTH Stripes<a class="hash-link" aria-label="Direct link to GTH Stripes" title="Direct link to GTH Stripes" href="/docs/Products/MLink/#gth-stripes">​</a></h4>
<table><thead><tr><th>Stripe</th><th>Ticker Source</th></tr></thead><tbody><tr><td>V</td><td>CFE</td></tr><tr><td>X1</td><td>CME</td></tr><tr><td>X2</td><td>CBOT</td></tr><tr><td>X3</td><td>NYMEX</td></tr><tr><td>X4</td><td>COMEX</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="compound-gth-stripe">Compound GTH Stripe<a class="hash-link" aria-label="Direct link to Compound GTH Stripe" title="Direct link to Compound GTH Stripe" href="/docs/Products/MLink/#compound-gth-stripe">​</a></h4>
<table><thead><tr><th>Stripe</th><th>Ticker Source</th></tr></thead><tbody><tr><td>X</td><td>X1<!-- -->:X4</td></tr></tbody></table>
<p>Note that stripes are exclusive, if a ticker is found within a specfic stripe, it will not be available in another. Ending ticker is not included in a stripe.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="websocket-active-latency">Websocket Active Latency<a class="hash-link" aria-label="Direct link to Websocket Active Latency" title="Direct link to Websocket Active Latency" href="/docs/Products/MLink/#websocket-active-latency">​</a></h3>
<p>MLinkStream contains an ActiveLantency field that governs subsequent updates after the initial (cache) query.  If this field is set to 0 then the user is required to send a SignalReady message which will trigger the MLinkServer to send an update (if any) to all response messages.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="mlinksignalready">MLinkSignalReady<a class="hash-link" aria-label="Direct link to MLinkSignalReady" title="Direct link to MLinkSignalReady" href="/docs/Products/MLink/#mlinksignalready">​</a></h4>
<table><thead><tr><th>Field Name</th><th>Field Type</th><th>Description</th></tr></thead><tbody><tr><td>sessionID</td><td>short</td><td>(optional) actions below apply only to the sessionID virtual session; should be zero for non-multiplexed web-socket connections.</td></tr><tr><td>signalID</td><td>GroupingCode</td><td>(optional) will be reflected back in xCheckPt.signalID fields that indicates that a specified signal ready triggered active send is complete.</td></tr><tr><td>readyScan</td><td>enum</td><td>(optional; default is Incremental) Incremental = messages w/changes (all fields; cumulative changes) since previous MLinkSignalReady; FullScan = all messages.</td></tr></tbody></table>
<p>Note:</p>
<ul>
<li>It is possible for the MLinkServer to have received multiple updates to a single Primary Key between successive SignalReady messages. If this occurs, only the most recent record update will be forwarded to the client.</li>
<li>If activelyLatency is set to any integer N greater than or equal to zero it will have the effect of automatically triggering the transmission of any pending updates every N milliseconds with zero being interpreted as no delay.</li>
<li>If the client system is unable to process messages at the speed with which they are being sent, MLinkServer will fall back to sending messsages at the rate the client is able to receive, which will also result is some messages being skipped in favor of more recent updates.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="mlinksignalready-and-liveimpliedquoteadj-stream">MLinkSignalReady and LiveImpliedQuoteAdj stream<a class="hash-link" aria-label="Direct link to MLinkSignalReady and LiveImpliedQuoteAdj stream" title="Direct link to MLinkSignalReady and LiveImpliedQuoteAdj stream" href="/docs/Products/MLink/#mlinksignalready-and-liveimpliedquoteadj-stream">​</a></h4>
<p>The undelier-adjusted version of LiveImpliedQuote records used in parrallel with MLinkSignalReady allow users to recalculate surfaces on demand. All records returned by the MLinkServer will be adjusted for the latest underlying price for each specific ticker.</p>
<p>After opening up a connection and setting the activeLatency to 0, users can send a series of MLinkSignalReady messages with a readyScan of FullScan to generate an underlier-adjusted reponse. With reasonable interval time between each, users can actively sample the LiveImpliedQuoteAdj message.</p>
<p>The following 2 message requests allow for this:</p>
<p>SignalReady (Should be sent in intervals through the same connection)</p>
<div class="language-Python language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">signal </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;header&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&quot;mTyp&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;MLinkSignalReady&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string" style="color:#e3116c">&quot;message&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&quot;readyScan&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;FullScan&quot;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#[readyScan:enum:ReadyScan:None=0,Incremental=2,FullScan=3]  </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>MLinkStream</p>
<div class="language-Python language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">msg </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string" style="color:#e3116c">&quot;header&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token string" style="color:#e3116c">&quot;mTyp&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;MLinkStream&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string" style="color:#e3116c">&quot;message&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token string" style="color:#e3116c">&quot;queryLabel&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ExampleImpliedQuoteAdj&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token string" style="color:#e3116c">&quot;activeLatency&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#wait for Signal ready</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token string" style="color:#e3116c">&quot;msgName&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;LiveImpliedQuoteAdj&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token string" style="color:#e3116c">&quot;where&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;ticker:eq:AAPL-NMS-EQT&quot;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#can also do ticker.tk:eq:AAPL &amp; ticker.at:eq:EQT &amp; ticker.ts:eq:NMS</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Please refer to client-python\JSONFramed\examples\clientSignalReady.py for further examples.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="establishing-a-connection">Establishing a connection<a class="hash-link" aria-label="Direct link to Establishing a connection" title="Direct link to Establishing a connection" href="/docs/Products/MLink/#establishing-a-connection">​</a></h3>
<p>After authenticating a websocket connection:</p>
<ul>
<li>The first message sent from the client to MLink
must be an &quot;MLinkLogon&quot; message containing either an API Key or SessionKey.</li>
<li>The first message sent from MLink to the client will be an &quot;MLinkAdmin&quot; message containing an application state [LoggedOn, WaitingForLogon, AuthError, OtherError] depending on the authentication state.</li>
</ul>
<p>If at any time during a session, a user sends an MLinkLogon message, the server will attempt to (re-)authenticate the user and will return an MLinkAdmin message.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="protocol-usage-1">Protocol Usage<a class="hash-link" aria-label="Direct link to Protocol Usage" title="Direct link to Protocol Usage" href="/docs/Products/MLink/#protocol-usage-1">​</a></h3>
<ul>
<li>
<p><strong>JSON</strong> - Standard JSON, each websocket frame can only contain one JSON message at a time.</p>
<p>Import Classes:</p>
<div class="language-Python language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> asyncio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> websockets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> nest_asyncio</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> threading</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> datetime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nest_asyncio</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">apply</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Authentication:</p>
<div class="language-Python language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">uriJson </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;wss://mlink-live.nms.saturn.spiderrockconnect.com/mlink/json&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">apiKey </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;your api key&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;your password&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">api_key_token </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">apiKey</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">.</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">password</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Asynchronously query AAPL:</p>
<div class="language-Python language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">recv_msg</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">websocket</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token builtin">buffer</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> websocket</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">recv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  parts </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">filter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token builtin">buffer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">b&#x27;\r\n&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> msg </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> parts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> json</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loads</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;\n&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">query_mlink</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">api_key_token</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  retry </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> retry</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> websockets</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">connect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uriJson</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        extra_headers</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;Authorization&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Bearer </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">api_key_token</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ping_timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> websocket</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        msg </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&quot;header&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string" style="color:#e3116c">&quot;mTyp&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;MLinkStream&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&quot;message&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string" style="color:#e3116c">&quot;queryLabel&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ExampleStockNbbo&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string" style="color:#e3116c">&quot;activeLatency&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#stream</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string" style="color:#e3116c">&quot;msgName&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;StockBookQuote&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string" style="color:#e3116c">&quot;where&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;ticker.tk:eq:AAPL | ticker.at:eq:EQT | ticker.ts:eq:NMS&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        t </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">time_ns</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tstr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;.&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">strftime</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;%Y-%m-%d %H:%M:%S&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gmtime</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">t </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000000000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;%06d&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">t </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        msg</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;header&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;sTim&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tstr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        msg</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;header&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;encT&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tstr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        smsg </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> json</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dumps</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> websocket</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">send</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">smsg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        notDone </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> notDone</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          notDone </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> recv_msg</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">websocket</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          retry </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">False</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">except</span><span class="token plain"> asyncio</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">exceptions</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TimeoutError</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;timeout occurred, retrying...&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p><strong>Framed JSON</strong> - SpiderRock JSON with protobuf-like header.</p>
<p>Same as JSON above, except for the parser:</p>
<div class="language-Python language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">query_mlink</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">api_key_token</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  retry </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> retry</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">try</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> websockets</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">connect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uriJson</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        extra_headers</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string" style="color:#e3116c">&quot;Authorization&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;Bearer </span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">{</span><span class="token string-interpolation interpolation">api_key_token</span><span class="token string-interpolation interpolation punctuation" style="color:#393A34">}</span><span class="token string-interpolation string" style="color:#e3116c">&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ping_timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">None</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> websocket</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        msg </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&quot;header&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string" style="color:#e3116c">&quot;mTyp&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;MLinkStream&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">&quot;message&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string" style="color:#e3116c">&quot;queryLabel&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;ExampleStockNbbo&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string" style="color:#e3116c">&quot;activeLatency&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#stream</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string" style="color:#e3116c">&quot;msgName&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;StockBookQuote&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string" style="color:#e3116c">&quot;where&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">&quot;ticker.tk:eq:AAPL &amp; ticker.at:eq:EQT &amp; ticker.ts:eq:NMS&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        t </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">time_ns</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        tstr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;.&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">strftime</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;%Y-%m-%d %H:%M:%S&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gmtime</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">t</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1000000000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token string" style="color:#e3116c">&quot;%06d&quot;</span><span class="token operator" style="color:#393A34">%</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">t</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">%</span><span class="token number" style="color:#36acaa">1000000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        msg</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;header&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;sTim&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tstr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        msg</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;header&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;encT&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> tstr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        smsg </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> json</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dumps</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        jmsg </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;\r\nJ&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;%011d&#x27;</span><span class="token operator" style="color:#393A34">%</span><span class="token builtin">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">smsg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> smsg</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">#header</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> websocket</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">send</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">jmsg</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        notDone </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> notDone</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token builtin">buffer</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> websocket</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">recv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          parts </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token builtin">list</span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">filter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">None</span><span class="token punctuation" style="color:#393A34">,</span><span class="token builtin">buffer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">b&#x27;\r\n&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> msg </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> parts</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> json</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">loads</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">msg</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">12</span><span class="token punctuation" style="color:#393A34">:</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;\n&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">except</span><span class="token plain"> asyncio</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">exceptions</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">TimeoutError</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token keyword" style="color:#00009f">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;timeout occurred, retrying...&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
</ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Products/FIX/order-entry-specs/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">order-entry-specs</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Products/SRSE/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">SRSE</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a class="table-of-contents__link toc-highlight" href="/docs/Products/MLink/#table-of-contents">Table of Contents</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/Products/MLink/#message-patterns">Message Patterns</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/Products/MLink/#1-rest-api">1. REST API</a><ul><li><a class="table-of-contents__link toc-highlight" href="/docs/Products/MLink/#protocol-usage">Protocol Usage</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/Products/MLink/#rest-commands">REST Commands:</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/Products/MLink/#rest-examples">Rest Examples</a></li></ul></li><li><a class="table-of-contents__link toc-highlight" href="/docs/Products/MLink/#2-websocket-api">2. Websocket API</a><ul><li><a class="table-of-contents__link toc-highlight" href="/docs/Products/MLink/#websocket-parameters---mlinkstream">Websocket Parameters - MLinkStream:</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/Products/MLink/#websocket-parameters---mlinksubscribe">Websocket Parameters - MLinkSubscribe:</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/Products/MLink/#mlink-stripes">MLink Stripes</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/Products/MLink/#websocket-active-latency">Websocket Active Latency</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/Products/MLink/#establishing-a-connection">Establishing a connection</a></li><li><a class="table-of-contents__link toc-highlight" href="/docs/Products/MLink/#protocol-usage-1">Protocol Usage</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">© 2024 SpiderRock Holdings, LLC. All rights reserved.</div></div></div></footer></div>
</body>
</html>